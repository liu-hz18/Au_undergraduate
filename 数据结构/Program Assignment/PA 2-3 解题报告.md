# **PA 2-3 解题报告**

##### 刘泓尊   2018011446   计84

### 一、数据结构与算法构思

#### 1.算法——Tarjan-BCC缩点+DFS

##### **1.1 思路来源**

​		根据提示，只有图上的割点可以成为必经点，而割点连接的是一对双连通分量。所以首先采用Tarjan的BCC算法对双连通分量进行缩点，重建图，之后对重建后的图DFS即可，从初始点到终点的通路上的点就是“必经点”。

##### **1.2 参考资料**

​		课程讲义:求BCC, 07-D2;

​		关于缩点的方式，我曾与课程小助教董博文交流。

##### **1.3 算法思路**

​		图的存储方式为邻接链表。

**1.3.1 BCC**

​		求BCC过程如下：

```
1.当v是第一个被访问的节点时，LOW[v] = DFN[v]
2.当回退边(v,w)被检查时，LOW[v] = min(LOW(v), DFN(w))
3.DFS过程中对v的儿子s完全扫描后返回到v时，
		LOW(v) = min(LOW(v), LOW(s))
```

​		同时，在BCC过程中，对记录每一个节点所述的双连通分量，将双连通分量的id加入该节点对应的双连通分量列表中。

**1.3.1 重建图**

​		遍历每个原始节点的双连通分量列表，如果size > 1说明其为割点。由此可新建一个（缩）点，作为重建图中的一个点，加入邻接表。

**1.3.2 DFS**

​		根据给出的问询，给出每个点所属的双连通分量（即缩完后的点），之后对起点终点的缩点进行DFS，用栈沿途记录搜索路径，搜索失败时弹栈，最终栈里的节点就是所有的必经点。再加上始终点自身即可形成答案。

### **二、过程中遇到的问题及解决**

1. 	割点属于多个BCC，因此要用链表或向量存储，不能只记录割点属于的其中一个BCC，不然会影响重建图时节点之间的连接关系。

### **三、时间和空间复杂度估算**

##### **1. 时间复杂度**

​		BCC缩点过程要访问所有的点和边，O(n+e)，则BCC+重建图复杂度
$$
T_B(n) = O(n + e) + O(n'+e') = O(n + e)
$$
​		设缩点后新图G = (n', e'),则每次问询(DFS)时间复杂度为O(n'+e')
$$
T_Q(n) = O(n'+e')
$$

##### **2. 空间复杂度**

​	存储原图和新图的邻接链表复杂度为O(n), BCC过程需要大小为O(e)的栈存储访问的边。递归方式将产生O(n)的运行栈，总共O(n + e)

$$
S(n) = O(n+e)
$$

​	DFS(问询)和BCC过程很相似，则DFS过程所占空间复杂度同BCC缩点相同。