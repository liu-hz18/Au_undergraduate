# PA 1-2 解题报告

##### 刘泓尊  2018011446   计84

### 一、数据结构与算法构思——二分查找

#### 1.思路来源

​		本题描述中注明了“保证任意两条线段不相交”，所以n条线段必然形成一个从 靠近原点 到 远离原点 的有序序列，因此可以很方便的使用**二分查找**。  

#### 2.参考资料

​		1. OJ 中题目的**提示**。

​		2. 对于两个int相乘的数据溢出问题，我从课程微信群中“刘禹潇”同学与其他同学的讨论中受到启发，**将int在计算前转化为long long**。

#### 3.算法思路

​		1.由于输入数据保证了两条直线之间互不相交，所以在将读入的x,y坐标分别排序（sort）之后，对应位置的x,y相连便代表了一条直线，且直线呈递增关系，因此可以应用**二分查找**。

​		2.设直线截距式方程为：
$$
\frac{x}{a} + \frac{y}{b} = 1,\quad a > 0,\quad b > 0
$$
​		在判断某点是否在一条直线的某一侧时，可以通过向量的 toleft 测试 判断。即直线向量与直线某一端点与该点连线向量的叉积。由于本问题的特殊性，所有的直线都为x正半轴连接y正半轴，因此对于点（x_0,y_0)的 toleft 测试 可以简化为：
$$
bx_0 + ay_0 < ab, \quad when\quad in \quad left\quad  side.\\
bx_0 + ay_0 = ab, \quad when\quad on\quad the\quad line.\\
bx_0 + ay_0 > ab, \quad when\quad in\quad right\quad side.
$$

#### 4.二分查找的具体过程

​		在二分查找中，实际上应该查找的该点所在的”区域“索引，但是为了减少对”区域“的判断，可以对点与直线位置关系进行判断，每次检查该点是否在索引为mid的直线右侧（包括在直线上）并且在索引为mid+1的直线左侧，就可以判断该点是不是在该区域。**该区域的索引值就是该点与原点连线的交点总数。**代码思路 如下：

```C++
//二分查找，返回交点个数
二分查找中的关键步骤在于位置的判断，我的思路为：如果该点在第mid直线右侧，且在第mid + 1直线左侧，说明直线有mid + 1个交点，return mid + 1。否则如果不在该区域内，在左侧就high = mid,在右侧就将low = mid+1.
```



### 二、过程中遇到的问题及解决

####  1.大整数相乘的溢出问题

​	在向量的toleft测试模块中，我如果直接进行向量的toleft测试（其转化为乘法的等价形式），会造成int的数据溢出，所以要在运算之前转化为long long再进行大小判断。（此更改是受微信群中“刘禹潇”同学对其他同学该问题的提醒而得到的提醒，在此表示感谢！）。

### 三、时间和空间复杂度估算

#### 1.时间复杂度

​		对于单个点的问询，toleft测试复杂度为O(1),二分查找复杂度为O(logn).

​		设检测的点个数为m,对于m个点的快速排序时间复杂度为O(nlogn),则总时间复杂度为:
$$
O((m+n)logn)
$$


#### 2.空间复杂度

​		本程序中，我为问询点对建立了数组，并为每个直线建立了对象，所以总空间复杂度为：
$$
O(m+n)
$$
