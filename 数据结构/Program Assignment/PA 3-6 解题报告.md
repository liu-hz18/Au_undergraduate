# **PA 3-6 解题报告**

##### 刘泓尊   2018011446   计84

### 一、数据结构与算法构思

#### 1.四路归并排序

#### **1.1 思路来源**

​		对于基于比较的排序，排序时间正比于比较次数。本题提供了三个数的比较器，一次比较可以获得三个数的大小关系，也就相当于3次两个数之间的比较。

​		由于给出了调用次数限制，所以本题任务是最小化比较次数，显然在o(nlogn)的排序算法中选择，且排序算法最坏情况不能是o(n^2),(尽管这对于快速排序等，出现最坏的情况很小，但还是担心会被极端数据卡)。**因此，归并排序平均、最好、最坏均为o(nlogn)的特点符合本题的要求**，不会因为数据的缺点导致比较次数的大幅增加。

#### **1.2 获得的帮助**

​		1.归并排序：参考了课程讲义中二路归并的部分02-F2

#### **1.3 思路**

**1.3.1 四路归并减少比较次数的证明**

​		基于归并排序思路，我们可以根据三数比较器的特点优化比较次数。可以发现，**四路归并可以减少一半的比较次数**。具体分析如下：

​		三数比较器一次可以获得三个数之间的大小关系，在四路归并过程中，原则是每次选择四路中最小加入结果序列。

​		假设已经取出前三个序列(x1,x2,x3)一个最小的一个，不妨设为x1，且最大的一个是x3， 则x1加入已排好序的序列，剩余新的1,2,3,4路中，已知x2 < x3，则再次取最小值只需要对(x1,x2,x4)进行排序，选出最小者加入有序序列 (因为x3肯定不是最小的)。

​		因此，**四路归并时，每调用比较器一次就可以向有序序列中加入一个元素。**设调用次数为F(n),则
$$
F(n) = 4F(n /4) + o(n)
$$
得到
$$
F(n) = o(nlog_4n) = \frac{1}{2}o(nlogn)
$$
因此，比较次数比二路归并减少一半。

```
对于最大规模n = 1000000，比较次数约为9965784次，符合本题要求。
```

**1.3.2 一些细节**

​		当四路中某一路归并完成时，变为**三路归并**，此时 依然可以利用三个数的比较器，每次选出最小的一个加入有序序列即可。而对于一般二路归并，三个序列排序需要2次比较，因此，三路归并调用次数仍为二路归并的一半。

​		对于只剩2路的情况，只需要将三个数的比较换为两个数的比较，此时在比较次数上没有优化，但在数据完全随机情况下，退化为2路归并的规模并不大，所以不会影响算法性能。

### 三、时间和空间复杂度估算

##### **1. 时间复杂度**

​		基于1.3.1节的分析，设时间复杂度为T(n),可以得到递推公式
$$
T(n) = 4T(n/4)+o(n)
$$
由主定理得到时间复杂度：
$$
T(n) = O(nlog_4n) = O(nlogn)
$$

**2. 比较次数**

​		根据1.3.1节的分析，比较次数F(n),
$$
F(n) = \frac{1}{2}O(nlogn)
$$
**3. 空间复杂度**

​		四路归并时需要三个辅助数组将原来的序列copy一份，o(3n)。 如果再考虑递归开销，再加上o(4^log_4 n) = o(n)。所以总空间复杂度为

$$
S(n) = O(n)
$$

